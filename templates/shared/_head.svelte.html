<svelte:head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">

  <title>{ content.title } | { content.organization || 'Star Tribune' }</title>

  <meta name="author" content="{ content.author || 'Star Tribune Visuals' }">
  <meta name="description" content="{ content.socialDescription }">
  <meta name="robots" content="index, follow">

  <!-- Shortcut and related icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="./assets/images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="./assets/images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="./assets/images/favicons/favicon-16x16.png">
  <link rel="manifest" href="./assets/images/favicons/manifest.json">
  <link rel="mask-icon" href="./assets/images/favicons/safari-pinned-tab.svg" color="#5bbad5">
  <link rel="shortcut icon" href="./assets/images/favicons/favicon.ico">
  <meta name="msapplication-config" content="./assets/images/favicons/browserconfig.xml">
  <meta name="theme-color" content="#ffffff">

<!-- For proper phone zoom -->
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Global/external styles -->
{#if config.styles && config.styles.globals }
  {#each config.styles.globals as s }
    <link href="{ s }" rel="stylesheet" type="text/css">
  {/each}
{/if}

<!-- Project-specific styles-->
<link rel="stylesheet" href="./styles/{ cms && cms.styles ? cms.styles : id }.bundle.css" type="text/css">

<!-- Social Media Tags -->
<meta property="og:type" content="website">
<meta property="og:url" content="{ config.publish ? config.publish.production.url : './' }">
<meta property="og:title" content="{ content.title }">
<meta property="og:description" content="{ content.socialDescription }">
{#if config.social && config.social.image }
  <meta property="og:image" content="{ config.publish ? config.publish.production.url : './' }{ config.social ? config.social.image : '' }">
{/if}

<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="{ content.twitterAccount || '@StarTribune' }">
<meta name="twitter:title" content="{ content.title }">
<meta name="twitter:description" content="{ content.socialDescription }">
{#if config.social && config.social.image }
  <meta name="twitter:image" content="{ config.publish ? config.publish.production.url : './' }{ config.social ? config.social.image : '' }">
{/if}

<!-- Google structured data -->
{@html structuredData }

<!-- Google Analytics -->
{@html googleAnalytics }
</svelte:head>

<script>
  export default {
    computed: {
      googleAnalytics: ({ config }) => {
        // Svelte ignores svelte syntax within a <script> tag
        return !config.googleAnalytics
          ? ""
          : `
            <script type="text/javascript">
              (function(i, s, o, g, r, a, m) {
                i["GoogleAnalyticsObject"] = r;
                (i[r] =
                  i[r] ||
                  function() {
                    (i[r].q = i[r].q || []).push(arguments);
                  }),
                  (i[r].l = 1 * new Date());
                (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
                a.async = 1;
                a.src = g;
                m.parentNode.insertBefore(a, m);
              })(
                window,
                document,
                "script",
                "https://www.google-analytics.com/analytics.js",
                "ga"
              );

              ga("create", "${config.googleAnalytics}", "auto");
              ga("send", "pageview");
            <\/script>
          `;
      },

      structuredData: ({ config, content }) => {
        // Svelte ignores svelte syntax within a <script> tag
        return `
            <script type="application/ld+json">
              {
                "@context": "http://schema.org",
                "@type": "NewsArticle",
                "mainEntityOfPage": {
                  "@type": "WebPage",
                  "@id": "${config.publish.production.url}"
                },
                "headline": "${content.title}",,
                "description": "${content.socialDescription}",
                "image": {
                  "@type": "ImageObject",
                  "url": "${config.publish.production.url}${
          config.social ? config.social.image : ""
        }"
                },
                "author": {
                  "@type": "Person",
                  "name": "${content.author || "Star Tribune Visuals"}"
                },
                "publisher": {
                  "@type": "Organization",
                  "name": "${content.organization || "Star Tribune"}",
                  "logo": {
                    "@type": "ImageObject",
                    "url": "${
                      config.publish ? config.publish.production.url : "./"
                    }assets/images/strib/strib-logo-transparent-307.png",
                    "width": 307,
                    "height": 292
                  }
                }
              }
            <\/script>
          `;
      }
    }
  };
</script>
